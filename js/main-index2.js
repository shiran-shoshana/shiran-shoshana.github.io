require(["jquery","jquery/ui","mage/translate"],(function(e){const t=20;var s=function(e,s){var n=1==e?0:e*t,r=t<window.stores.length?n+t:window.stores.length;s=void 0!==s?s:window.stores;for(var i=n;i<r;i++)jQuery("#storelist").append(a(s[i]));o(e,s),jQuery(".tab-shops .count, .h1 .count").text(s.length)},o=function(e,s){if(s.length<=t)return!1;jQuery("#storelist").append(jQuery('<div class="pagination"></div>'));for(var o=1;o<=s.length/t;o++){var a="";o==e&&(a=" active"),jQuery(".pagination").append('<div class="pagep'+a+'" data-page="'+o+'">'+o+"</div>")}},a=function(e){var t="",s="";return e?(e&&"1"===e?.shipping&&(s='<div class="greenlabel">עושים משלוחים</div>'),e&&null==e?.business_type&&(e.business_type=0),t+='<div class="shopone" data-storeid="'+e?.store_id+'" date-bus="'+e?.business_type+'">',t+=s,t+='<div class="shop-img">',t+='<img class="tmp-store-img" src="'+window.urlImg+'/images/shop-tmp-img.svg" alt="'+e?.name+'">',t+="</div>",t+='<div class="shopinfo">',t+='<h3 class="shopname">'+e?.name+"</h3>",t+='<div class="address-and-city"><span class="address">'+e?.address+'</span><span class="city">'+e?.city+"</span></div>",t+='<div class="shop-btns"><div class="telbtn"><a href="tel:'+e?.phone+'"><span class="pnoneicon"></span><span class="phonetxt">התקשרו לחנות</span>',t+='<span class="phonenum">'+e?.phone+"</span></a></div>",null!=typeof e?.website&&/^(?:(?:(?:https?|ftp):)?\/\/)(?:\S+(?::\S*)?@)?(?:(?!(?:10|127)(?:\.\d{1,3}){3})(?!(?:169\.254|192\.168)(?:\.\d{1,3}){2})(?!172\.(?:1[6-9]|2\d|3[0-1])(?:\.\d{1,3}){2})(?:[1-9]\d?|1\d\d|2[01]\d|22[0-3])(?:\.(?:1?\d{1,2}|2[0-4]\d|25[0-5])){2}(?:\.(?:[1-9]\d?|1\d\d|2[0-4]\d|25[0-4]))|(?:(?:[a-z\u00a1-\uffff0-9]-*)*[a-z\u00a1-\uffff0-9]+)(?:\.(?:[a-z\u00a1-\uffff0-9]-*)*[a-z\u00a1-\uffff0-9]+)*(?:\.(?:[a-z\u00a1-\uffff]{2,})))(?::\d{2,5})?(?:[/?#]\S*)?$/i.test(e?.website)&&(t+='<div class="websitebtn"><a href="'+e?.website+'"> לאתר החנות </a></div>'),t+='<div class="mobile-gps"><a href="#"><span class="gps-icon"></span><span class="gps-text">ניווט לחנות</span></a>\n</div>',t+="</div></div></div>"):t},n=function(t,o){var n=[];if(e(".storelocator-wrp .h1").show(),e("#storelist").html(""),""==t&&""==o)return s(1),!1;n=""==t||void 0===t?window.stores:r(t),""!==o&&void 0!==o&&(n=i(o,n));var u=jQuery(".tab-shops#tab-shops .count").length?jQuery(".tab-shops#tab-shops .count"):jQuery(".count");if(n.length>0){for(var c=0;c<n.length;c++)jQuery("#storelist").append(a(n[c]));u.text(n.length)}else jQuery("#storelist").html("<p>"+e.mage.__("Shop not found")+"</p>"),u.text(0)},r=function(e){return window.stores.filter((function(t){if(t.city.includes(e))return!0}))},i=function(e,t){return t.filter((function(t){return Number(t.business_type)==e}))};e(document).ready((function(){e(document).on("submit","#searchShopForm",(function(t){t.preventDefault(),t.stopImmediatePropagation();var s=e("#searchShopForm"),o=s.find("#s1"),a=s.find("#s2");n(o.val(),a.val())})),e(document).on("click",".pagep",(function(t){console.log(e(this).data("page"))}));var o=jQuery("body");if(o.hasClass("cms-index-index")&&(jQuery("#shopCities").autocomplete({source:shopCities,minlength:2,position:{my:"right top",at:"right bottom"},change:function(e,t){null==t.item&&(e.currentTarget.value="",e.currentTarget.focus())},select:function(e,t){console.log("Selected: "+t.item.value),console.log(t),location.href="/store-locator/?search="+t.item.value}}),jQuery(".storesearch-w form").on("submit",(function(e){e.preventDefault(),e.stopImmediatePropagation();var t=jQuery('.storesearch-w form input[type="text"]');if(""==t.val())return t.css("border-color","red"),!1;location.href="/store-locator/?search="+t.val()})),jQuery('.storesearch-w form input[type="text"]').on("focus",(function(){jQuery(this).css("border-color","inherit")}))),o.hasClass("catalog-product-view")&&jQuery('button[type="button"].action.primary.tocart').on("click",(function(e){e.preventDefault(),e.stopImmediatePropagation();let t=document.querySelector(".product-sku-value").getAttribute("data-value"),s=document.querySelector("#firmParam").value;location.href="/store-locator/?sku="+t+"&brand="+s+"&page=product"})),o.hasClass("mpblog-post-view")){document.querySelectorAll("[data-role=tocart-form]").forEach((e=>{e.addEventListener("submit",(e=>{e.preventDefault(),e.stopImmediatePropagation();let t=e.target.getAttribute("data-product-sku");location.href="/store-locator/?sku="+t+"&brand=erez&page=product"}))}))}if(o.hasClass("storelocator-index-index"))if("false"!==window.searchQ){let e=decodeURI(window.searchQ);n(e)}else s(1,t),window.ShowPage=1;o.hasClass("catalogsearch-result-index")&&(isNaN(window.searchCount)||jQuery("#tab-products .count").text("("+window.searchCount+")")),e(".level1.parent").hover((function(){e(this).find(".level1.submenu").show()}),(function(){e(this).find(".level1.submenu").hide()}));const a=()=>{document.documentElement.style.setProperty("--app-height",`${window.innerHeight}px`)};window.addEventListener("resize",a),a()}))}));